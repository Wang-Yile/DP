# 同余最短路

同余最短路通过构造状态优化时空复杂度。

题目形式：给定整数序列 $a_n$，可以重复取，问

1. 能拼凑出多少个其他整数；
2. 不能拼凑出的最小（最大）的整数；
3. 至少要拼几次才能拼出模 $M$ 余 $p$ 的数。

不妨 $a_n$ 是递增序列。

处理方法是设 $f_i$ 表示模 $a_1$ 余 $i$ 的最小整数 $p$。

容易得到转移式：

$$f_{(i + a_j) \mod a_1} = f_i + a_j$$

转化为图上问题，即为从 $i$ 向 $(i + a_j) \mod a_1$ 连一条长度为 $a_j$ 的边。

跑一次最短路就可以求出序列 $f_0, f_1, f_2, \dots, f_{a_1 - 1}$。

**当存在一组解 $f$ 时，$f + a_1$ 也一定为一组解。**

那么区间 $[1, R]$ 的答案为 $\sum \limits_{i = 0}^{a_1 - 1} \left[ \dfrac{R - f_i}{a_1} + 1 \right]$，$[x]$ 表示 $x$ 的向下取整。（$+1$ 是因为 $f$ 也是一组可行解）

**P3403** 跳楼机